# Gap analysis vs similar projects (Payload template) 

Date: 2026-02-10

## Reference projects reviewed
- Payload CMS official **website** template (monolithic Next app):
  - `payloadcms/payload` → `templates/website`

## What the template has that we *don’t yet*

### 1) Real Payload ↔ Next wiring (Admin UI + REST routes)
The template includes generated routes like:
- `src/app/(payload)/admin/[[...segments]]/page.tsx` (admin)
- `src/app/(payload)/api/[...slug]/route.ts` (REST)
- a Payload layout wrapper (`@payloadcms/next/layouts`) + import map

**We have not integrated these yet** because we’re keeping `apps/cms` as a separate service and want to implement this carefully with tests and minimal footguns.

### 2) Payload import map generation
Template uses an import map file under `admin/importMap.js` generated by Payload.

We need a predictable script like:
- `payload generate:importmap`

…and a convention for where our Payload config lives so the CLI works.

### 3) Auth collection
Template includes a `Users` collection and sets `admin.user = Users.slug`.

We need this for Phase 1 (Payload auth now, SSO later).

### 4) Scheduler / jobs for scheduled publishing
Template shows a `jobs` section in config with an access function that can allow:
- logged-in users, or
- a cron secret header

We need this to implement scheduled publish in a cloud-friendly way:
- AWS EventBridge → hit an endpoint / task with secret
- later: Kubernetes CronJob

### 5) Media storage adapters
Template supports upload + image processing (often with `sharp`) and storage adapters.

For our AWS best practice:
- dev: local disk
- prod: S3 (stateless CMS)

### 6) Preview / revalidation
Template includes patterns for preview and revalidation.

For our split apps (Astro web + CMS):
- web build may be static + periodic rebuild, or
- later: on-demand rebuild / ISR-like behavior (depends on hosting approach)

## What we already have that’s aligned
- Monorepo structure (web + cms + shared)
- CI pipeline running tests
- Content model scaffolding docs: SEO + scheduled + shorts/video + disclosures

## Immediate next steps (to close the biggest gaps)
1) Add a `Users` collection + Payload config that sets `admin.user`
2) Introduce Payload Next routes under `apps/cms/src/app/(payload)`
3) Add scripts:
   - `generate:importmap`
   - (later) `generate:types`
4) Keep builds green and add smoke tests around config boot

